<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.21">
<link rel="icon" type="image/png" href="images/icons/OliveTinLogo.png">
<title>OliveTin documentation</title>
<style>
body {
  font-family: sans-serif;
  line-height: 1.5;
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-areas: "nav content" "nav footer";
  grid-template-columns: 20em auto;
  grid-template-rows: auto min-content;
  height: 100vh;
  align-items: stretch;
}

a {
  text-decoration: none;
}

a:focus {
  background-color: #bdb76b;
}

#header {
  background-color: #efefef;
  grid-area: nav;
}

#footer {
  grid-area: footer;
  justify-self: center;
  align-self: end;
  padding: 1em;
}

#toc {
  padding: 1em;
}

#toc a {
  color: black;
}

#toc li {
  padding-bottom: .6em;
}

#toc ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

#toc ul ul {
  padding-left: 1.4em;
}

#toctitle {
  font-weight: bold;
  color: black;
}

h1 {
  font-size: 1.4em;
  font-weight: lighter;
  background-color: black;
  padding: .6em;
  margin: 0;
  color: white;
}

#toc a:hover {
  text-decoration: underline;
}

#content {
  background-color: white;
  grid-area: content;
  max-width: 1000px;
  padding: 1em;
  justify-self: center;
}

#content img {
  max-width: 100%;
  vertical-align: middle;
}

pre {
  background-color: #f7f7f8;
  padding: 1em;
  word-wrap: break-word;
  white-space: no-wrap;
  overflow: auto;
}

table {
  border-collapse: collapse;
}

td, th {
  border: 1px solid gray;
  padding: .4em;
}

th {
  background-color: #f9f9f9;
  text-align: left;
}

.imageblock.right {
  float: right;
}

hr {
  clear: both;
  border: 0;
  border-bottom: 1px solid #efefef;
  margin: 1em;
}

div.admonitionblock.note {
  background-color: beige;
}

div.admonitionblock td {
  border: 0;
}

div.admonitionblock td:first-child {
  font-weight: bold;
}

.listingblock .title {
  background-color: #efefef;
  margin-bottom: -1em;
  padding: 1em;
}

@media (max-width: 700px) {
  body {
    display: block;
  }
}

</style>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="output-views" class="book toc2 toc-left">
<div id="header">
<h1>OliveTin</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">OliveTin documentation</a></span></p><ul class="sectlevel1">
<li><a href="installation.html">1. Installation Guide</a>
</li>
<li><a href="config.html">2. Configuration</a>
</li>
<li><a href="reverse-proxies.html">3. Reverse Proxies</a>
</li>
<li><a href="actions.html">4. Actions</a>
</li>
<li><a href="action-customisation.html">5. Action customisation</a>
</li>
<li><a href="examples.html">6. Action examples</a>
</li>
<li><a href="args.html">7. Arguments</a>
</li>
<li><a href="dashboards.html">8. Dashboards</a>
<ul class="sectlevel2">
<li><a href="_the_actions_section.html">8.1. The "actions" section</a>
</li>
<li><a href="fieldsets.html">8.2. Fieldsets</a>
</li>
<li><a href="folders.html">8.3. Folders (Directories)</a>
</li>
<li><a href="displays.html">8.4. Displays</a>
</li>
<li><a href="output-views.html"><span class="toc-current">8.5. Most recent action output</span></a>
</li>
</ul>
</li>
<li><a href="_its_often_useful_to_turn_logging_to_debug_when_trying_to_work_out_authentication_problems.html">It&#8217;s often useful to turn logging to DEBUG when trying to work out authentication problems</a>
</li>
<li><a href="_this_config_has_two_actions_which_are_applied_to_all_container_entities.html">This config has two actions which are applied to all "container" entities </a>
</li>
<li><a href="_found_in_the_entity_file.html">found in the entity file.</a>
</li>
<li><a href="_docs_httpdocs_olivetin_appentities_html.html">Docs: http://docs.olivetin.app/entities.html</a>
</li>
<li><a href="_the_only_way_to_properly_use_entities_are_to_use_them_with_a_fieldset_on.html">The only way to properly use entities, are to use them with a <code>fieldset</code> on</a>
</li>
<li><a href="_a_dashboard.html">a dashboard.</a>
</li>
<li><a href="_build.html">Build:</a>
</li>
<li><a href="_runtime.html">Runtime:</a>
</li>
<li><a href="_config.html">Config:</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect2">
<h3 id="output-views"><a class="anchor" href="#output-views"></a><a class="link" href="#output-views">8.5. Most recent action output</a></h3>
<div class="paragraph">
<p>This is considered an advanced and experimental feature at the moment.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you execute too frequently (like every 5-10 seconds) OliveTin is prone to crashing. This will be fixed later.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you are running a status command, you should use <code>execOnStartup</code> and <code>execOnCron</code> to make sure it is ready for when the webui loads, or OliveTin is likely to crash.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>actions:
  - title: Get status
    id: status_command
    shell: date
    execOnStartup: true
    execOnCron:
      - "*/1 * * * *"

dashboards:
  - title: Control Panel
    contents:
      - title: Status
        type: fieldset
        contents:
          - type: stdout-most-recent-execution
            title: status_command

[#entities]
== Entities

An entity is something that exists - a "thing", like a VM, or a Container is an entity. OliveTin allows you to then dynamically generate actions based around these entities.

This is really useful if you want to generate wake on lan or poweroff actions for `server` entities, for example.

A very popular use case that entities were designed for was for `container` entities - in a similar way you could generate `start`, `stop`, and `restart` container actions.

Entities are just loaded fome files on disk, OliveTin will also watch these files for updates while OliveTin is running, and update entities.

Entities can have properties defined in those files, and those can be used in your configuration as variables. For example; `container.status`, or `vm.hostname`.

[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>entities:
  - file: /etc/OliveTin/containers.json
    name: container</p>
</div>
<div class="ulist">
<ul>
<li>
<p>file: /etc/OliveTin/servers.yaml
name: server</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Entity Actions can only be used on &lt;&lt;dashboards,Dashboards&gt;&gt;.

[#entities-yaml]
=== YAML entity files

YAML files are the default expected format, so you can use .yml, .yaml, or even .txt - as long as the file contains a valid yaml LIST, then it will be loaded.

.`/etc/OliveTin/servers.yaml`
[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>server1:
  state: started
  hostname: server1.example.com
  ip: 192.168.0.1
server2:
  state: started
  hostname: server2.example.com
  ip: 192.168.0.2
server3:
  state: stopped
  hostname: server3.example.com
  ip: 192.168.0.3</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[#entities-json]
=== JSON entity files

JSON files are parsed as if each line is a single JSON object. This can be super helpful for getting a list of containers, for example; `docker ps -a --format=json &gt; /etc/OliveTin/containers.json`.

[source,json]
.`/etc/OliveTin/containers.json`</pre>
</div>
</div>
<div class="paragraph">
<p>{"Command":"\"/opt/entrypoint.sh\"","CreatedAt":"2024-02-08 15:27:42 +0000 GMT","ID":"4bafe6f9f956","Image":"fedora","Labels":"?","LocalVolumes":"0","Mounts":"","Names":"media-indexing-container","Networks":"bridge","Ports":"","RunningFor":"13 days ago","Size":"0B","State":"exited","Status":"Exited (128) 13 days ago"}
{"Command":"\"/opt/entrypoint.sh\"","CreatedAt":"2023-12-17 20:58:03 +0000 GMT","ID":"d25f37c49c35","Image":"fedora","Labels":"?","LocalVolumes":"0","Mounts":"","Names":"media-playback-container","Networks":"bridge","Ports":"","RunningFor":"27 days ago","Size":"0B","State":"exited","Status":"Exited (137) 27 days ago"}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>== Advanced Configuration

This section includes optional configuration options that are used less frequently by most users.

[#customize-webui]
=== Customize the web UI

The OliveTin web UI is reasonably customizable - parts of the page that you don't need can be hidden when they're not needed.

==== Page Title

You can customize the page title;

image::images/page-title.png[]

.`config.yaml`
[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>pageTitle: My OliveTin Instance</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[#show-nav]
==== Show Navigation

You can choose to hide the navigation elements in OliveTin, to present a simplified user interface.

.The default user interface with the "Actions" and "Settings" buttons shown.
image::images/defaultUiWithNav.png[]

To have OliveTin hide these buttons, add `showNavigation: false` to your config.yaml;

.`config.yaml`
[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>logLevel: "INFO"
showNavigation: false</p>
</div>
<div class="paragraph">
<p>actions:
    &#8230;&#8203;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.The same user interface, but with the "Actions" and "Settings" buttons hidden (`showNavigation: false`)
image::images/defaultUiHideNav.png[]

[#show-new-versions]
==== Show new versions

You can disable the "new version" information in the footer - the default for `showNewVersions` is `true`;

.`config.yaml`
[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>logLevel: "INFO"
showNewVersions: false</p>
</div>
<div class="listingblock">
<div class="content">
<pre>If disabled, OliveTin will still check for new versions in the background, but will not display them on the page. If you want to disable update checking completely, see &lt;&lt;disable-update-checks,disable update checking&gt;&gt;.

[#show-footer]
==== Show the footer

You can disable the entire footer, if you would like a really minimal interface. The default for `showFooter` is `true`.

.`config.yaml`
[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>logLevel: "INFO"
showFooter: false</p>
</div>
<div class="listingblock">
<div class="content">
<pre>This means the &lt;&lt;show-new-versions,`showNewVersions`&gt;&gt; configuration option will automatically be `false` as well.

[#log-levels]
=== Log Levels
OliveTin supports a few different log levels. The default logLevel is `INFO`.

You can set a `logLevel` in config.yaml like this;

.`config.yaml`
[source,yaml]</pre>
</div>
</div>
<div class="paragraph">
<p>logLevel: "INFO"</p>
</div>
<div class="paragraph">
<p>actions:
    &#8230;&#8203;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The supported log levels are;

* `DEBUG` - Every possible log message will be shown. This will use a lot of disk space and is not recommended unless you are a developer / like reading code.
* `ERROR` - OliveTin rarely uses the `ERROR` log level.
* `WARN` - Very few messages, only warnings are shown.
* `INFO` - The defualt log level.

You can change the `logLevel` while OliveTin is running, and it should update as soon as you save your config.yaml. You will always get a log message like this;

[source,bash]</pre>
</div>
</div>
<div class="paragraph">
<p>INFO Setting log level to warning</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[#ports]
=== Ports

See &lt;&lt;network-ports,the network ports&gt;&gt; documentation in the reference section.

[#timezone]
=== Timezone

OliveTin will obviously use the system time just like all other programs, but when running in a container, time works in a slightly unusual way.

You may be used to using a TZ or TIMEZONE environment variable in your Linux container inages, but this is not a standard that works for all Linux distributions - it's mostly supported by Debain based containers. OliveTin's base container image is fedora-minimal, which deliberately does not include timezone data, to reduce storage space.

To change the time in the OliveTin container, simply bind-mount the correct zone file;

.Same as the container host</pre>
</div>
</div>
<div class="paragraph">
<p>docker create -v /etc/localtime:/etc/localtime -v /etc/OliveTin:/config --name OliveTin docker.io/jamesread/olivetin</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.Different timezone to the container host</pre>
</div>
</div>
<div class="paragraph">
<p>docker create -v /usr/share/zoneinfo/Japan:/etc/localtime -v /etc/OliveTin:/config --name OliveTin docker.io/jamesread/olivetin</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[#auth]
== Authentication &amp; Authorization

See &lt;&lt;auth-concepts,concepts&gt;&gt; for a good overview of how this works in OliveTin.

[#auth-concepts]
=== Concepts

OliveTin does not have any built-in code for doing **Authentication** (ie: entering a username and password), however it can do **Authorization** (ie: checking permissions of a user who logged in via another system, like single sign on).

A popular way of deploying OliveTin is by users accessing it via another system, like a &lt;&lt;reverse-proxies,reverse proxy&gt;&gt; (eg: Traefik) or a "homepage" app (eg: Organizr). Both of these are used to handle user authentication first, before users then access OliveTin. Permissions can then be applied inside OliveTin depending on who has logged in.

The flow generally goes like this;

1. User browses to a website like Organizr and logs in, which sets a JWT Cookie for apps.example.com.
2. User browses to OliveTin.apps.example.com, and the cookie is sent to OliveTin.
3. OliveTin verifies the JWT token given the signing secret, and picks up on the `name` and `group` fields from the JWT claim.
4. OliveTin matches any relevant ACLs based on the claims.
5. If any ACLs are not matched, then the defaultPermissions are used.

[#trusted-header]
=== Trusted Header Authorization

This method is not yet well documented, sorry! Ask on Discord - we need more people to test this feature.</pre>
</div>
</div>
<div class="paragraph">
<p>authHttpHeaderUsername: "X-Username"
authHttpHeaderUsergroup: "X-Usergroup"</p>
</div>
<div class="listingblock">
<div class="content">
<pre>NOTE: You *must* set `AuthHttpHeaderUsername` to some value, even if you only intend to use `AuthHttpHeaderUsergroup`, otherwise usergroups will be ignored.

[#jwt]
=== JWT Authorization

You need to know your JWT **Cookie Name** and **Hash Secret**. Whatever tool you are using to authenticate users will probably have instructions on how to find this.

* link:https://docs.organizr.app/features/server-authentication#validating-the-token[Organizr - Under "Validating the token"]

==== Adding JWT details to OliveTin config.yaml

Setup your config file so it has something like this;</pre>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="displays.html">Displays</a> | ↑ Up: <a href="dashboards.html">Dashboards</a> | ⌂ Home: <a href="index.html">OliveTin documentation</a> | Next: <a href="_its_often_useful_to_turn_logging_to_debug_when_trying_to_work_out_authentication_problems.html">It&#8217;s often useful to turn logging to DEBUG when trying to work out authentication problems</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-03-05 22:54:39 UTC
</div>
</div>
</body>
</html>